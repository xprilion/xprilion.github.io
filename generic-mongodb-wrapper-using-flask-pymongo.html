<!DOCTYPE html><html lang="en" class="__variable_6ab973"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/22966f4f11fece13-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/3df4cf0b22f61940-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/a481f011d1f4a14b-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/feff4f1fc62fae3c-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/2dba37557e579c7e.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/17c99d248f3289f7.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/f3b8208e8dab82f4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-0e89f3edb1eec667.js"/><script src="/_next/static/chunks/a82cbd8b-b3a1b1aa1798277d.js" async=""></script><script src="/_next/static/chunks/261-9869fd9e23c1aca9.js" async=""></script><script src="/_next/static/chunks/main-app-60c99745b0326fba.js" async=""></script><script src="/_next/static/chunks/app/layout-29f44809ba3fe938.js" async=""></script><script src="/_next/static/chunks/943-eb5c9570e2ea5452.js" async=""></script><script src="/_next/static/chunks/328-beff309a0d839380.js" async=""></script><script src="/_next/static/chunks/224-ed8f8dcad199b1cb.js" async=""></script><script src="/_next/static/chunks/app/(blog)/%5Bslug%5D/page-07658ccddd456ca2.js" async=""></script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js" as="script"/><meta name="next-size-adjust" content=""/><link rel="icon" type="image/png" href="/apple-icon.png" sizes="96x96"/><link rel="icon" type="image/svg+xml" href="/icon0.svg"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><meta name="apple-mobile-web-app-title" content="xprilion&#x27;s blog"/><link rel="manifest" href="/manifest.json"/><meta name="theme-color" content="#7b46f6"/><meta property="og:title" content="xprilion&#x27;s blog"/><meta property="og:description" content="Hey, I&#x27;m Anubhav Singh. I love building software, mixing stacks and making memes."/><meta property="og:image" content="/favicon.png"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@xprilion"/><meta name="twitter:creator" content="@xprilion"/><meta name="twitter:title" content="xprilion&#x27;s blog"/><meta name="twitter:description" content="Hey, I&#x27;m Anubhav Singh. I love building software, mixing stacks and making memes."/><meta name="twitter:image" content="/favicon.png"/><meta itemProp="name" content="xprilion&#x27;s blog"/><meta itemProp="description" content="Hey, I&#x27;m Anubhav Singh. I love building software, mixing stacks and making memes."/><meta itemProp="image" content="/favicon.png"/><title>A Generic MongoDB Wrapper API with Flask and PyMongo</title><meta name="description" content="Hey there, hope you&#x27;re well! It&#x27;s been a while since I wrote something here, to my defence I wrote this tutorial about How to setup a secure, remote JupyterLab workstation on DigitalOcean. Have you not read it yet? Go ahead and explore it if you&#x27;re interested in the topic! Now, moving ahead.

This blog is going to be about creating a generic wrapper API for your MongoDB installation using Flask and PyMongo. If you&#x27;ve little idea about what these terms mean, here we go -


1. PyMongo and MongoDB
"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="antialiased"><script>((e,t,r,n,o,a,i,u)=>{let l=document.documentElement,s=["light","dark"];function c(t){var r;(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,n=r&&a?o.map(e=>a[e]||e):o;r?(l.classList.remove(...n),l.classList.add(a&&a[t]?a[t]:t)):l.setAttribute(e,t)}),r=t,u&&s.includes(r)&&(l.style.colorScheme=r)}if(n)c(n);else try{let e=localStorage.getItem(t)||r,n=i&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(n)}catch(e){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="max-w-6xl mx-auto px-1 md:px-4 font-gentium"><div class="flex flex-col min-h-screen px-2 md:px-4 bg-background text-foreground"><nav class="flex flex-row justify-between items-center py-4 border-b border-border relative"><a class="flex items-center justify-center" href="/"><h1 class="text-xl sm:text-2xl m-0 text-foreground font-normal leading-normal inline-block font-gentium-book truncate max-w-[200px] sm:max-w-none">xprilion&#x27;s blog</h1></a><div class="flex items-center gap-4"><div class="hidden lg:flex items-center font-gentium text-lg"><div><a class="m-1 text-blue-600 dark:text-primary hover:text-blue-600 dark:hover:text-primary hover:underline" href="/posts">Posts<!-- --> </a></div><div><span class="my-1 text-foreground"> · </span><a class="m-1 text-blue-600 dark:text-primary hover:text-blue-600 dark:hover:text-primary hover:underline" href="/talks">Talks<!-- --> </a></div><div><span class="my-1 text-foreground"> · </span><a class="m-1 text-blue-600 dark:text-primary hover:text-blue-600 dark:hover:text-primary hover:underline" href="/publications">Publications<!-- --> </a></div><div><span class="my-1 text-foreground"> · </span><a class="m-1 text-blue-600 dark:text-primary hover:text-blue-600 dark:hover:text-primary hover:underline" href="/codelabs">Codelabs<!-- --> </a></div></div><button id="mobile-menu-button" type="button" class="flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 lg:hidden text-3xl rounded-full border-2 border-foreground dark:invert dark:border-background" style="background-image:url(/ellipses.png);background-size:50%;background-position:50%;background-repeat:no-repeat" aria-label="Toggle navigation menu" aria-expanded="false"></button></div></nav><main class="flex-grow max-w-3xl mx-auto w-full py-8 px-1 md:px-4"><div class="mb-6"><a class="text-blue-600 hover:underline mb-4 block" href="/posts">← Back to all posts</a><h1 class="text-2xl md:text-3xl font-bold mb-2">A Generic MongoDB Wrapper API with Flask and PyMongo</h1><p class="text-gray-600 dark:text-gray-200 text-sm ">14 September, 2020</p></div><div class="prose prose-blue max-w-none"></div><script>(self.__next_s=self.__next_s||[]).push([0,{"children":"\n          MathJax = {\n            tex: {\n              inlineMath: [['((', '))']],\n              displayMath: [['[[', ']]']],\n            },\n            svg: {\n              fontCache: 'global'\n            }\n          };\n        ","id":"MathJax-config"}])</script></main><div class="w-full mx-auto py-6 max-w-6xl px-4 border-t border-border"><div class="flex flex-col sm:flex-row justify-between gap-2"><div class="text-center sm:text-left text-foreground">© Anubhav Singh <!-- -->2025</div><div class="text-center sm:text-right"><a class="text-foreground hover:text-blue-600 dark:hover:text-primary" href="/sitemap.xml">Sitemap</a><span class="mx-1 text-foreground">·</span><a class="text-foreground hover:text-blue-600 dark:hover:text-primary" href="/newsletter">Newsletter</a></div></div></div></div></div><!--$--><!--/$--><!--$--><!--/$--><script src="/_next/static/chunks/webpack-0e89f3edb1eec667.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[6575,[\"177\",\"static/chunks/app/layout-29f44809ba3fe938.js\"],\"ThemeProvider\"]\n3:I[4922,[],\"\"]\n4:I[3720,[],\"\"]\n6:I[2466,[],\"MetadataBoundary\"]\n8:I[2466,[],\"OutletBoundary\"]\nb:I[6114,[],\"AsyncMetadataOutlet\"]\nd:I[2466,[],\"ViewportBoundary\"]\nf:I[4797,[],\"\"]\n:HL[\"/_next/static/media/22966f4f11fece13-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/3df4cf0b22f61940-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/a481f011d1f4a14b-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/feff4f1fc62fae3c-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/2dba37557e579c7e.css\",\"style\"]\n:HL[\"/_next/static/css/17c99d248f3289f7.css\",\"style\"]\n:HL[\"/_next/static/css/f3b8208e8dab82f4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"cHwBVV_Xyza83Flv9oUys\",\"p\":\"\",\"c\":[\"\",\"generic-mongodb-wrapper-using-flask-pymongo\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"generic-mongodb-wrapper-using-flask-pymongo\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/2dba37557e579c7e.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/17c99d248f3289f7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__variable_6ab973\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"href\":\"/apple-icon.png\",\"sizes\":\"96x96\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/svg+xml\",\"href\":\"/icon0.svg\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"180x180\",\"href\":\"/apple-touch-icon.png\"}],[\"$\",\"meta\",null,{\"name\":\"apple-mobile-web-app-title\",\"content\":\"xprilion's blog\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/manifest.json\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#7b46f6\"}],[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",null,{\"itemProp\":\"name\",\"content\":\"xprilion's blog\"}],[\"$\",\"meta\",null,{\"itemProp\":\"description\",\"content\":\"Hey, I'm Anubhav Singh. I love building software, mixing stacks and making memes.\"}],[\"$\",\"meta\",null,{\"itemProp\":\"image\",\"content\":\"/favicon.png\"}],[\"$\",\"meta\",null,{\"property\":\"og:title\",\"content\":\"xprilion's blog\"}],[\"$\",\"meta\",null,{\"property\":\"og:description\",\"content\":\"Hey, I'm Anubhav Singh. I love building software, mixing stacks and making memes.\"}],[\"$\",\"meta\",null,{\"property\":\"og:image\",\"content\":\"/favicon.png\"}],[\"$\",\"meta\",null,{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:site\",\"content\":\"@xprilion\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:creator\",\"content\":\"@xprilion\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:title\",\"content\":\"xprilion's blog\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:description\",\"content\":\"Hey, I'm Anubhav Singh. I love building software, mixing stacks and making memes.\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:image\",\"content\":\"/favicon.png\"}]]}],[\"$\",\"body\",null,{\"className\":\"antialiased\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}]]}],{\"children\":[\"(blog)\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:style\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":\"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:children:props:children:1:props:style\",\"children\":404}],[\"$\",\"div\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:children:props:children:2:props:style\",\"children\":[\"$\",\"h2\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:children:props:children:2:props:children:props:style\",\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"generic-mongodb-wrapper-using-flask-pymongo\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[\"$\",\"$L6\",null,{\"children\":\"$L7\"}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f3b8208e8dab82f4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L8\",null,{\"children\":[\"$L9\",\"$La\",[\"$\",\"$Lb\",null,{\"promise\":\"$@c\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"Ih_wQez_E32JfU_vOmaAc\",{\"children\":[[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:\"$Sreact.suspense\"\n11:I[6114,[],\"AsyncMetadata\"]\n7:[\"$\",\"$10\",null,{\"fallback\":null,\"children\":[\"$\",\"$L11\",null,{\"promise\":\"$@12\"}]}]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"13:I[1701,[\"943\",\"static/chunks/943-eb5c9570e2ea5452.js\",\"328\",\"static/chunks/328-beff309a0d839380.js\",\"224\",\"static/chunks/224-ed8f8dcad199b1cb.js\",\"356\",\"static/chunks/app/(blog)/%5Bslug%5D/page-07658ccddd456ca2.js\"],\"default\"]\n14:I[1999,[\"943\",\"static/chunks/943-eb5c9570e2ea5452.js\",\"328\",\"static/chunks/328-beff309a0d839380.js\",\"224\",\"static/chunks/224-ed8f8dcad199b1cb.js\",\"356\",\"static/chunks/app/(blog)/%5Bslug%5D/page-07658ccddd456ca2.js\"],\"\"]\n15:I[1106,[\"943\",\"static/chunks/943-eb5c9570e2ea5452.js\",\"328\",\"static/chunks/328-beff309a0d839380.js\",\"224\",\"static/chunks/224-ed8f8dcad199b1cb.js\",\"356\",\"static/chunks/app/(blog)/%5Bslug%5D/page-07658ccddd456ca2.js\"],\"default\"]\n17:I[4046,[\"943\",\"static/chunks/943-eb5c9570e2ea5452.js\",\"328\",\"static/chunks/328-beff309a0d839380.js\",\"224\",\"static/chunks/224-ed8f8dcad199b1cb.js\",\"356\",\"static/chunks/app/(blog)/%5Bslug%5D/page-07658ccddd456ca2.js\"],\"\"]\n16:T2f5d,"])</script><script>self.__next_f.push([1,"\u003chr\u003e\u003cp\u003eHey there, hope you're well! It's been a while since I wrote something here, to my defence I wrote this tutorial about \u003ca href=\"https://www.digitalocean.com/community/tutorials/how-to-set-up-a-jupyterlab-environment-on-ubuntu-18-04\"\u003eHow to setup a secure, remote JupyterLab workstation\u003c/a\u003e on \u003ca href=\"https://digitalocean.com\"\u003eDigitalOcean\u003c/a\u003e. Have you not read it yet? Go ahead and explore it if you're interested in the topic! Now, moving ahead.\u003c/p\u003e\u003cp\u003eThis blog is going to be about creating a generic wrapper API for your MongoDB installation using Flask and PyMongo. If you've little idea about what these terms mean, here we go -\u003c/p\u003e\u003ch2 id=\"1-pymongo-and-mongodb\"\u003e1. PyMongo and MongoDB\u003c/h2\u003e\u003cp\u003eWhen you're working with the cool \u003ca href=\"https://mongodb.com\"\u003eMongoDB\u003c/a\u003e using Python, \u003ca href=\"https://pymongo.readthedocs.io/en/stable/\"\u003ePyMongo\u003c/a\u003e is your go to tool. The distribution facilitates a full fledged support for interacting with MongoDB databases, local or remote and provides a dead simple way of working with it through your Python code.\u003c/p\u003e\u003ch2 id=\"2-flask\"\u003e2. Flask\u003c/h2\u003e\u003cp\u003eA very popular library in Python for creating web sites, often preferred for lightweight tasks and more often for creating API servers quickly, \u003ca href=\"https://flask.palletsprojects.com\"\u003eFlask\u003c/a\u003e provides a way to have a no-frills web server running in minutes.\u003c/p\u003e\u003ch2 id=\"3-you\"\u003e3. You\u003c/h2\u003e\n\u003c!--kg-card-begin: html--\u003e\n\u003cimg loading=\"lazy\" src=\"https://media1.tenor.com/images/07feba4572471b21fd4258b6af83c9c4/tenor.gif\" /\u003e\n\u003c!--kg-card-end: html--\u003e\n\u003cp\u003eA super cool person reading this nice blog for whom I hope I can make the time spent here worth!\u003c/p\u003e\u003cp\u003eNow that we're done with the introductions, let's chalk out a plan that we shall follow in this tutorial. Imagine a situation where you have a MongoDB database with yourselves, and are wondering how to use it for some basic \u003ca href=\"https://en.wikipedia.org/wiki/Create,_read,_update_and_delete\"\u003eCRUD\u003c/a\u003e operations from a remotely running application. Further, to make things interesting, you're unsure what collections in the database your application shall need, or it may even need to create arbitrary collections at any moment. Fortunately, you hit upon the golden idea of creating some public APIs to your database server using Flask which allow just those operations with our without some authentication, as per your need.\u003c/p\u003e\u003cp\u003eWhile I'm going to leave the (tiny) headache of getting a MongoDB server to you, which you can easily get on many online providers, even for free at some places, I shall begin with the requirements of our API.\u003c/p\u003e\u003ch2 id=\"the-specification\"\u003eThe specification\u003c/h2\u003e\u003cp\u003eIf you went through the specification of CRUD, you know that we need 4 REST APIs to begin with -\u003c/p\u003e\n\u003c!--kg-card-begin: html--\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eAction\u003c/th\u003e\n\u003cth\u003eMethod\u003c/th\u003e\n\u003cth\u003eMongoDB\u003c/th\u003e\n\u003cth\u003eParameters\u003c/th\u003e\n\u003cth\u003eEndpoint\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eCreate\u003c/td\u003e\n\u003ctd\u003ePOST, PUT\u003c/td\u003e\n\u003ctd\u003eInsert\u003c/td\u003e\n\u003ctd\u003eNone\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"http://example.com/table\"\u003eexample.com/table\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eRead All/One\u003c/td\u003e\n\u003ctd\u003eGET\u003c/td\u003e\n\u003ctd\u003eFind\u003c/td\u003e\n\u003ctd\u003eNone/Resource ID\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"http://example.com/table/%5Bid%5D\"\u003eexample.com/table/[id]\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUpdate\u003c/td\u003e\n\u003ctd\u003ePOST, PUT, PATCH\u003c/td\u003e\n\u003ctd\u003eUpdate\u003c/td\u003e\n\u003ctd\u003eResource ID\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"http://example.com/table/id\"\u003eexample.com/table/id\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eDelete\u003c/td\u003e\n\u003ctd\u003eDELETE\u003c/td\u003e\n\u003ctd\u003eDelete\u003c/td\u003e\n\u003ctd\u003eResource ID\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"http://example.com/table/id\"\u003eexample.com/table/id\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003c!--kg-card-end: html--\u003e\n\u003ch2 id=\"the-preparation\"\u003eThe preparation\u003c/h2\u003e\u003cp\u003eNow, we shall make sure we have some helper code ready for usage, usually to handle any errors on the API or simply to respond to an \"are you alive\" ping from anywhere remote.\u003c/p\u003e\u003cp\u003eFirst off, you'd need the right libraries installed. We shall be using the \u003ccode\u003eflask_pymongo\u003c/code\u003e which is a wrapper around PyMongo with helpers for Flask provided. Besides, we will need the \u003ccode\u003eflask_cors\u003c/code\u003e library to \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\"\u003eallow fetching of resources from a different domain\u003c/a\u003e.\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-bash\"\u003epip install flask, flask_pymongo, flask_cors\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eLet's import these libraries (and others which might be needed) into our script.\u003c/p\u003e\u003ch3 id=\"step-1-importing-libraries\"\u003eStep 1: Importing libraries\u003c/h3\u003e\u003cp\u003eCreate a file named \u003ca href=\"http://app.py\"\u003e\u003ccode\u003eapp.py\u003c/code\u003e\u003c/a\u003e in your working directory. Add the following lines to import all needed libraries -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003eimport os\nfrom flask import Flask, request, make_response\nfrom flask_pymongo import PyMongo, ObjectId\nfrom flask_cors import CORS\nimport datetime\nfrom bson.json_util import dumps\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"step-2-setup-constants-mongodb-connection-and-helper-objects\"\u003eStep 2: Setup constants, MongoDB connection and helper objects\u003c/h3\u003e\u003cp\u003eNow, let us define the stuff we shall be needing globally in the code.\u003c/p\u003e\u003cp\u003eFirst, let's create an instance of our Flask app -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003eapp = Flask(__name__)\nCORS(app)\nAPP_ROOT = os.path.dirname(os.path.abspath(__file__))\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe \u003ccode\u003eCORS(app)\u003c/code\u003e enables CORS for the API we shall run. Next, let's define some HTTP status code responses we shall be making in the API.\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e# HTTP status code constants\nHTTP_SUCCESS_GET_OR_UPDATE          =   200\nHTTP_SUCCESS_CREATED                =   201\nHTTP_SUCCESS_DELETED                =   204\nHTTP_SERVER_ERROR                   =   500\nHTTP_NOT_FOUND                      =   404\nHTTP_BAD_REQUEST                    =   400\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThen, create a connection object for PyMongo -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003eapp.config[\"MONGO_URI\"] = \"mongodb://username:password@host:port/database?authSource=admin\"\nmongo = PyMongo(app)\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eFinally, we shall be creating a helper function that prepares the responses our API makes -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003edef send(data, status_code):\n    return make_response(dumps(data), status_code)\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis function will be responsible for preparing the data before finally giving it out through the API. Sometimes you might want global transforms on all output you're producing, this is where they go.\u003c/p\u003e\u003ch2 id=\"the-real-deal\"\u003eThe real deal\u003c/h2\u003e\u003cp\u003eNow, we can setup the APIs to wrap around PyMongo. Let us start with the \u003ccode\u003eCreate\u003c/code\u003e API.\u003c/p\u003e\u003ch3 id=\"step-4-create-api\"\u003eStep 4: Create API\u003c/h3\u003e\u003cp\u003eIn this step, I shall first put out the code for you to study, and then attempt explaining it.\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e@app.route('/\u0026lt;collection_name\u0026gt;', methods=['POST'])\ndef post_item(collection_name):\n    \"\"\"\n        Post one item in collection.\n    \"\"\"\n    collection = getattr(mongo.db, collection_name)\n    formdata = request.json\n    try:\n        insert_id = str(collection.insert_one(formdata).inserted_id)\n        output = {'message': 'new item created', \"_id\": insert_id}\n        return send(output, HTTP_SUCCESS_CREATED)\n    except Exception as e:\n        output = {'error' : str(e)}\n        return send(output, HTTP_BAD_REQUEST)\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eIn the code above, you see that we created a \u003ccode\u003e/\u0026lt;collection_name\u0026gt;\u003c/code\u003e route. This means that we have kept the collection name generic, and whatever collection name is being passed to it, the API will attempt to insert data into it, or if it doesn't exist yet in the database, it will first create the collection and then insert the item.\u003c/p\u003e\u003cp\u003eThe API returns an \u003ccode\u003eid\u003c/code\u003e which is useful for entry level operations like reading a single entry, updating it or deleting it.\u003c/p\u003e\u003ch3 id=\"step-5-read-api\"\u003eStep 5: Read API\u003c/h3\u003e\u003cp\u003eNext, we shall create an API to read the entries in the collection. There can be two instances of read - one in which you try to read exactly 1 entry and the other where you need all entries. Let us create these.\u003c/p\u003e\u003cp\u003eFirst, let's create an API that returns all items in a collection -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e@app.route('/\u0026lt;collection_name\u0026gt;', methods=['GET'])\ndef get_all_items(collection_name):\n    \"\"\"\n        Documents in a collection.\n    \"\"\"\n    collection = getattr(mongo.db, collection_name)\n    output = []\n    for q in collection.find():\n        output.append(q)\n    return send(output, HTTP_SUCCESS_GET_OR_UPDATE)\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow, any \u003ccode\u003eGET\u003c/code\u003e request to any \u003ccode\u003ecollection_name\u003c/code\u003e will attempt to display all items in that collection. If it does not exist, the API will simply return a blank list, but will not attempt to create the collection.\u003c/p\u003e\u003cp\u003eThen, let's create the route to get information about a single entry -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e@app.route('/\u0026lt;collection_name\u0026gt;/\u0026lt;id\u0026gt;', methods=['GET'])\ndef get_one_item(collection_name, id):\n    \"\"\"\n        Get one item from a collection.\n    \"\"\"\n    collection = getattr(mongo.db, collection_name)\n    r = collection.find_one({'_id': ObjectId(id)})\n    if r:\n        return send(r, HTTP_SUCCESS_GET_OR_UPDATE)\n    else:\n        return send({'error' : 'item not found'}, HTTP_NOT_FOUND)\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNotice that the above route accepts both \u003ccode\u003ecollection_name\u003c/code\u003e and \u003ccode\u003eid\u003c/code\u003e. This \u003ccode\u003eid\u003c/code\u003e is the one which is returned in the Create API.\u003c/p\u003e\u003ch3 id=\"step-6-update-api\"\u003eStep 6: Update API\u003c/h3\u003e\u003cp\u003eNow, let's create an API to allow updating one entry at a time. It would need to have both the \u003ccode\u003ecollection_name\u003c/code\u003e and \u003ccode\u003eid\u003c/code\u003e parameters and would be accessible by a \u003ccode\u003ePUT\u003c/code\u003e request.\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e@app.route('/\u0026lt;collection_name\u0026gt;/\u0026lt;id\u0026gt;', methods=['PUT'])\ndef update_item(collection_name, id):\n    \"\"\"\n        Update one item in collection.\n    \"\"\"\n    collection = getattr(mongo.db, collection_name)\n    r = collection.find_one({'_id': ObjectId(id)})\n    if r:\n        for key in request.json.keys():\n            r[key] = request.json[key]\n        try:\n            collection.replace_one({\"_id\": ObjectId(id)}, r)\n            output = {'message' : 'item updated'}\n            return send(output, HTTP_SUCCESS_GET_OR_UPDATE)\n        except Exception as e:\n            output = {'error' : str(e)}\n            return send(output, HTTP_BAD_REQUEST)\n    else:\n        output = {'error' : 'item not found'}\n        return send(output, HTTP_NOT_FOUND)\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNote that before we update the item, we check for its existence. You could skip this behaviour and could create an API which attempts to Create or Update, which is a popular requirement in many use cases.\u003c/p\u003e\u003ch3 id=\"step-7-delete-api\"\u003eStep 7: Delete API\u003c/h3\u003e\u003cp\u003eA rather simpler API, the Delete API too needs both the \u003ccode\u003ecollection_name\u003c/code\u003e and \u003ccode\u003eid\u003c/code\u003e and listens to the \u003ccode\u003eDELETE\u003c/code\u003e request.\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e@app.route('/\u0026lt;collection_name\u0026gt;/\u0026lt;id\u0026gt;', methods=['DELETE'])\ndef delete_item(collection_name, id):\n    \"\"\"\n        Delete one item from collection.\n    \"\"\"\n    collection = getattr(mongo.db, collection_name)\n    r = collection.find_one({'_id': ObjectId(id)})\n    if r:\n        try:\n            collection.remove(r[\"_id\"])\n            return send(\"\", HTTP_SUCCESS_DELETED)\n        except Exception as e:\n            output = {'error' : str(e)}\n            return send(output, HTTP_BAD_REQUEST)\n    else:\n        output = {'error' : 'item not found'}\n        return send(output, HTTP_NOT_FOUND)\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\u003cp\u003eWith the above APIs, and any more you might wish to add to it, you can have a simple API wrapper around your MongoDB database which allows you to work with any collection at any moment. To get the full code head over to \u003ca href=\"https://github.com/xprilion/generic-pymongo-flask\"\u003ehttps://github.com/xprilion/generic-pymongo-flask\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eIf you read through the code in the \u003ca href=\"http://app.py\"\u003e\u003ccode\u003eapp.py\u003c/code\u003e\u003c/a\u003e on the repository you'll find a few more functions there, which can be a useful addition to your API.\u003c/p\u003e\u003cp\u003eThanks for making time for going through this tutorial!\u003c/p\u003e"])</script><script>self.__next_f.push([1,"5:[\"$\",\"$L13\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-6\",\"children\":[[\"$\",\"$L14\",null,{\"href\":\"/posts\",\"className\":\"text-blue-600 hover:underline mb-4 block\",\"children\":\"← Back to all posts\"}],[\"$\",\"h1\",null,{\"className\":\"text-2xl md:text-3xl font-bold mb-2\",\"children\":\"A Generic MongoDB Wrapper API with Flask and PyMongo\"}],[\"$\",\"p\",null,{\"className\":\"text-gray-600 dark:text-gray-200 text-sm \",\"children\":\"14 September, 2020\"}]]}],null,[\"$\",\"$L15\",null,{\"html\":\"$16\",\"slug\":\"generic-mongodb-wrapper-using-flask-pymongo\",\"title\":\"A Generic MongoDB Wrapper API with Flask and PyMongo\"}],[\"$\",\"$L17\",null,{\"id\":\"MathJax-script\",\"src\":\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js\",\"async\":true,\"strategy\":\"afterInteractive\"}],[\"$\",\"$L17\",null,{\"id\":\"MathJax-config\",\"strategy\":\"beforeInteractive\",\"dangerouslySetInnerHTML\":{\"__html\":\"\\n          MathJax = {\\n            tex: {\\n              inlineMath: [['((', '))']],\\n              displayMath: [['[[', ']]']],\\n            },\\n            svg: {\\n              fontCache: 'global'\\n            }\\n          };\\n        \"}}]]}]\n"])</script><script>self.__next_f.push([1,"12:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"A Generic MongoDB Wrapper API with Flask and PyMongo\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Hey there, hope you're well! It's been a while since I wrote something here, to my defence I wrote this tutorial about How to setup a secure, remote JupyterLab workstation on DigitalOcean. Have you not read it yet? Go ahead and explore it if you're interested in the topic! Now, moving ahead.\\n\\nThis blog is going to be about creating a generic wrapper API for your MongoDB installation using Flask and PyMongo. If you've little idea about what these terms mean, here we go -\\n\\n\\n1. PyMongo and MongoDB\\n\"}]],\"error\":null,\"digest\":\"$undefined\"}\nc:{\"metadata\":\"$12:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>