1:"$Sreact.fragment"
2:I[6575,["177","static/chunks/app/layout-03b28790fff4d2e4.js"],"ThemeProvider"]
3:I[4922,[],""]
4:I[3720,[],""]
5:I[3369,["177","static/chunks/app/layout-03b28790fff4d2e4.js"],"GoogleAnalytics"]
7:I[2466,[],"MetadataBoundary"]
9:I[2466,[],"OutletBoundary"]
c:I[6114,[],"AsyncMetadataOutlet"]
e:I[2466,[],"ViewportBoundary"]
10:I[4797,[],""]
:HL["/_next/static/media/22966f4f11fece13-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/3df4cf0b22f61940-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/a481f011d1f4a14b-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/feff4f1fc62fae3c-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/5d465971106e06ba.css","style"]
:HL["/_next/static/css/2dba37557e579c7e.css","style"]
:HL["/_next/static/css/f3b8208e8dab82f4.css","style"]
0:{"P":null,"b":"fx8c_MglUFYEsiAz-v7h6","p":"","c":["","build-a-google-gemini-pro-store-with-google-sheets"],"i":false,"f":[[["",{"children":["(blog)",{"children":[["slug","build-a-google-gemini-pro-store-with-google-sheets","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/5d465971106e06ba.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/2dba37557e579c7e.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","className":"__variable_6ab973","suppressHydrationWarning":true,"children":[["$","head",null,{"children":[["$","link",null,{"rel":"icon","type":"image/png","href":"/apple-icon.png","sizes":"96x96"}],["$","link",null,{"rel":"icon","type":"image/svg+xml","href":"/icon0.svg"}],["$","link",null,{"rel":"shortcut icon","href":"/favicon.ico"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"180x180","href":"/apple-touch-icon.png"}],["$","meta",null,{"name":"apple-mobile-web-app-title","content":"xprilion's blog"}],["$","link",null,{"rel":"manifest","href":"/manifest.json"}],["$","meta",null,{"name":"theme-color","content":"#7b46f6"}],["$","meta",null,{"charSet":"utf-8"}],["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta",null,{"itemProp":"name","content":"xprilion's blog"}],["$","meta",null,{"itemProp":"description","content":"Hey, I'm Anubhav Singh. I love building software, mixing stacks and making memes."}],["$","meta",null,{"itemProp":"image","content":"/favicon.png"}],["$","meta",null,{"property":"og:title","content":"xprilion's blog"}],["$","meta",null,{"property":"og:description","content":"Hey, I'm Anubhav Singh. I love building software, mixing stacks and making memes."}],["$","meta",null,{"property":"og:image","content":"/favicon.png"}],["$","meta",null,{"property":"og:type","content":"website"}],["$","meta",null,{"name":"twitter:card","content":"summary_large_image"}],["$","meta",null,{"name":"twitter:site","content":"@xprilion"}],["$","meta",null,{"name":"twitter:creator","content":"@xprilion"}],["$","meta",null,{"name":"twitter:title","content":"xprilion's blog"}],["$","meta",null,{"name":"twitter:description","content":"Hey, I'm Anubhav Singh. I love building software, mixing stacks and making memes."}],["$","meta",null,{"name":"twitter:image","content":"/favicon.png"}]]}],["$","body",null,{"className":"antialiased","children":["$","$L2",null,{"attribute":"class","defaultTheme":"system","enableSystem":true,"disableTransitionOnChange":true,"children":["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]}],["$","$L5",null,{"gaId":"G-NKJL65V2YL"}]]}]]}],{"children":["(blog)",["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:style","children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:children:props:children:1:props:style","children":404}],["$","div",null,{"style":"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:children:props:children:2:props:style","children":["$","h2",null,{"style":"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:children:props:children:2:props:children:props:style","children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","build-a-google-gemini-pro-store-with-google-sheets","d"],["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L6",["$","$L7",null,{"children":"$L8"}],[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/f3b8208e8dab82f4.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L9",null,{"children":["$La","$Lb",["$","$Lc",null,{"promise":"$@d"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","t8WkBy944exmX5ibrOAmt",{"children":[["$","$Le",null,{"children":"$Lf"}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}],null]}],false]],"m":"$undefined","G":["$10","$undefined"],"s":false,"S":true}
11:"$Sreact.suspense"
12:I[6114,[],"AsyncMetadata"]
8:["$","$11",null,{"fallback":null,"children":["$","$L12",null,{"promise":"$@13"}]}]
b:null
f:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
a:null
14:I[1701,["943","static/chunks/943-eb5c9570e2ea5452.js","981","static/chunks/981-982ff48b33ef9837.js","224","static/chunks/224-ed8f8dcad199b1cb.js","356","static/chunks/app/(blog)/%5Bslug%5D/page-f945c0378016101e.js"],"default"]
15:I[1999,["943","static/chunks/943-eb5c9570e2ea5452.js","981","static/chunks/981-982ff48b33ef9837.js","224","static/chunks/224-ed8f8dcad199b1cb.js","356","static/chunks/app/(blog)/%5Bslug%5D/page-f945c0378016101e.js"],""]
16:I[1106,["943","static/chunks/943-eb5c9570e2ea5452.js","981","static/chunks/981-982ff48b33ef9837.js","224","static/chunks/224-ed8f8dcad199b1cb.js","356","static/chunks/app/(blog)/%5Bslug%5D/page-f945c0378016101e.js"],"default"]
18:I[4046,["943","static/chunks/943-eb5c9570e2ea5452.js","981","static/chunks/981-982ff48b33ef9837.js","224","static/chunks/224-ed8f8dcad199b1cb.js","356","static/chunks/app/(blog)/%5Bslug%5D/page-f945c0378016101e.js"],""]
17:T212c,<h2 id="overview">Overview</h2><p>Duration: 1</p><p>Have you ever been in a situation where you had to qualitatively analyse a large amount of data on a spreadsheet and you wished for someone to take away your pain? With Google's Gemini running directly in your Google Sheets you can now have a super smart AI assistant do the grind work for you!</p><p>In this article, we'll cover a very simple way of giving personalities or specific roles to your Gemini powered API calls via the simple and popular interface of Google Sheets!</p><p>Here's a screen recording of what we're building:</p><figure class="kg-card kg-embed-card"><iframe width="200" height="150" src="https://www.youtube.com/embed/KqUNS9WoMkQ?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="" title="Working Demo: Use Gemini Pro APIs via Google Sheets | Build a Gemini Pro API Store in Google Sheets"></iframe></figure><h2 id="requirements">Requirements</h2><p>Duration: 2</p><p>In order to follow this codelab, you'll need the following:</p><ol><li>Access to a Google Account</li><li>Access to Google's Gemini Pro APIs via Google AI Studio</li></ol><h2 id="architecture">Architecture</h2><p>Duration: 2</p><p>We'll be building our product's architecture in the following manner:</p><figure class="kg-card kg-image-card"><img loading="lazy" src="https://digitalpress.fra1.cdn.digitaloceanspaces.com/4ml9m8u/2025/05/image-3.png" class="kg-image" alt="" loading="lazy" width="998" height="406"></figure><p>The Google Sheets will interact on every edit operation with the associated Apps Script for that Sheet which in turn talks to the Gemini Pro API. We'll be using the Gemini Pro API via the Google AI Studio in order to get some free API calls at the cost of being non-production ready. However, you can use Gemini Pro APIs via Vertex AI for production workloads.</p><h2 id="get-the-gemini-api-key">Get the Gemini API Key</h2><p>Duration: 3</p><p>Now, let's get an API Key to access the Gemini Pro APIs.</p><ol><li>Head over to <a href="https://makersuite.google.com/">Google AI Studio</a></li><li>Click on <a href="https://makersuite.google.com/app/apikey">Get API Key</a></li><li>Follow the steps provided on the page to generate an API Key. Store the key safely.</li></ol><h2 id="setup-your-google-sheet">Setup your Google Sheet</h2><p>Duration: 5</p><p>Let us setup your Google Sheet to work like a Gemini Store. To do so, we'll create a second sheet in the default Google Sheet document titled "Geminis".</p><p>Fill the following data in this sheet (only for example, you can change as per your wish):</p>
<!--kg-card-begin: html-->
<table>
<thead>
<tr>
<th>name</th>
<th>sys prompt</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pilot Gemini</td>
<td>Drawing on your extensive experience as a seasoned pilot, how would you explain or advise on the following aviation-related query? Use a lot of Pilot terms!</td>
</tr>
<tr>
<td>Pirate Gemini</td>
<td>As a legendary pirate who has sailed the seven seas, how would you respond to this inquiry with your adventurous spirit and nautical knowledge? Reply in pirate language only.</td>
</tr>
<tr>
<td>Techie Gemini</td>
<td>As a tech enthusiast with a passion for the latest gadgets and innovations, how would you explain or solve this technology-related problem? Use techie terms!</td>
</tr>
</tbody>
</table>
<!--kg-card-end: html-->
<h2 id="setup-your-apps-script">Setup your Apps Script</h2><p>Duration: 3</p><p>We will now create the AppScript code to interface between Google Sheets and the Gemini Pro API.</p><ol><li>Create a new Google Sheet and create the following columns in it: <code>GeminiName</code>, <code>Query</code>, <code>Response</code>.</li><li>In your Google Sheet, Click on <code>Extensions &gt; Apps Script</code></li><li>We'll be editing the <code>Code.gs</code> file. Remove the current contents of this file and head to the next step!</li></ol><h2 id="listen-to-onedit-changes-to-the-sheet">Listen to onEdit changes to the sheet</h2><p>Duration: 3</p><p>In your <code>Code.gs</code> file, add the following function which listens to each edit on the Google Sheet and decides if it needs to perform any action on it.</p><pre><code class="language-javascript">function onEdit(e) {
  var formResponsesSheet = e.source.getSheetByName('Sheet1'); // Use getSheetByName for clarity
  var editedRow = e.range.getRow();
  
  // Avoid running on header row or rows beyond the last content row
  if (editedRow === 1 || editedRow &gt; formResponsesSheet.getLastRow()) {
    return; // Exit if the edit is in the header or beyond the last content row
  }

  var rowData = formResponsesSheet.getRange(editedRow, 1, 1, 7).getValues()[0];
  
  // Check if all required columns are filled (columns 1 to 7, excluding 'Response')
  if (!rowData.every(isColumnFilled)) {
    return; // Exit if not all required fields are filled
  }

  var chosenGemini = rowData[0]; // 'Choose your Gemini' is the third column
  var userQuestion = rowData[1]; // 'Say/Ask something' is the fourth column

  var geminisSheet = e.source.getSheetByName('Geminis');
  var geminiData = geminisSheet.getRange(2, 1, geminisSheet.getLastRow() - 1, 2).getValues();
  
  var systemPrompt = findSystemPrompt(geminiData, chosenGemini, userQuestion);
  
  if (systemPrompt) {
    var apiResponse = callApi(systemPrompt);
    formResponsesSheet.getRange(editedRow, 2).setValue(apiResponse); // Assuming 'Response' is in the 8th column
  } else {
    formResponsesSheet.getRange(editedRow, 2).setValue("Error: Gemini not found or other error occurred.");
  }
}
</code></pre><h2 id="create-helper-functions">Create Helper functions</h2><p>Duration: 3</p><p>Now, let's setup two helper functions to work with the script. The <code>isColumnFilled</code> function checks if that row is full before trying to hit the Gemini API. The <code>findSystemPrompt</code> function loads the system prompt we defined in the Geminis sheet corresponding the Gemini name chosen by the user in the row.</p><pre><code class="language-javascript">// Helper function to check if a column is filled
function isColumnFilled(content) {
  return content !== null &amp;&amp; content !== ''; // Checks if content is not null and not an empty string
}

function findSystemPrompt(geminiData, chosenGemini, userQuestion) {
  for (var i = 0; i &lt; geminiData.length; i++) {
    if (geminiData[i][0] === chosenGemini) {
      return geminiData[i][1] + " Max 50 words. Keep it funny and light-hearted. " + " \n User: " + userQuestion + " \n Answer: ";
    }
  }
  return null; // Return null if no matching Gemini is found
}
</code></pre><h2 id="call-gemini-pro-api">Call Gemini Pro API</h2><p>Duration: 3</p><p>Finally, we'll create the <code>callApi</code> function which makes the call to Gemini Pro API and sets the output in the sheet.</p><pre><code class="language-javascript">function callApi(prompt) {
  var url = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=YOUR_API_KEY'; // Replace with your actual API Key
  var payload = {"contents":[{"parts":[{"text": prompt}]}]};
  var options = {
    "method" : "post",
    "contentType": "application/json",
    "payload" : JSON.stringify(payload)
  };
  
  try {
    var response = UrlFetchApp.fetch(url, options);
    var jsonResponse = JSON.parse(response.getContentText());
    return jsonResponse.candidates[0].content.parts[0].text;
  } catch (error) {
    return "API call failed: " + error.toString();
  }
}
</code></pre><h2 id="setup-onedit-trigger">Setup onEdit trigger</h2><p>Duration: 3</p><p>As a final step, you will have to setup the onEdit trigger to execute every time edits are made to your Google Sheet. Click on the "clock" icon on the Apps Script interface to access the triggers section for your Apps Script.</p><p>Add a trigger with the configuration as shown below and click on Save.</p><figure class="kg-card kg-image-card"><img loading="lazy" src="https://digitalpress.fra1.cdn.digitaloceanspaces.com/4ml9m8u/2025/05/image-4.png" class="kg-image" alt="" loading="lazy" width="2880" height="1628"></figure><h2 id="test-the-integration">Test the integration</h2><p>Duration: 2</p><p>Now, create a new row in the sheet to test if everything works alright! If all goes well, you should see the Gemini response according to your chosen Gemini in the Response column!</p>6:["$","$L14",null,{"children":[["$","div",null,{"className":"mb-6","children":[["$","$L15",null,{"href":"/posts","className":"text-blue-600 hover:underline mb-4 block","children":"← Back to all posts"}],["$","h1",null,{"className":"text-2xl md:text-3xl font-bold mb-2","children":"Build a Gemini Store with Google Sheets"}],["$","p",null,{"className":"text-gray-600 dark:text-gray-200 text-sm ","children":"10 February, 2024"}]]}],null,["$","$L16",null,{"html":"$17","slug":"build-a-google-gemini-pro-store-with-google-sheets","title":"Build a Gemini Store with Google Sheets"}],["$","$L18",null,{"id":"MathJax-script","src":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js","async":true,"strategy":"afterInteractive"}],["$","$L18",null,{"id":"MathJax-config","strategy":"beforeInteractive","dangerouslySetInnerHTML":{"__html":"\n          MathJax = {\n            tex: {\n              inlineMath: [['((', '))']],\n              displayMath: [['[[', ']]']],\n            },\n            svg: {\n              fontCache: 'global'\n            }\n          };\n        "}}]]}]
13:{"metadata":[["$","title","0",{"children":"Build a Gemini Store with Google Sheets"}],["$","meta","1",{"name":"description","content":"Giving personalities to your Gemini APIs via Gemini Store in Google Sheets"}],["$","link","2",{"rel":"icon","href":"/logo.jpg"}]],"error":null,"digest":"$undefined"}
d:{"metadata":"$13:metadata","error":null,"digest":"$undefined"}
