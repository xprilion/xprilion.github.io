<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.12.11"/><meta data-react-helmet="true" itemProp="name" content="Build a Gemini Store with Google Sheets | xprilion&#x27;s blog"/><meta data-react-helmet="true" name="description" content="Overview
Duration: 1
Have you ever been in a situation where you had to qualitatively analyse a large amount of data on a spreadsheet and you wished for someone to take away your pain? With Google&#x27;s Gemini running directly in your Google Sheets you c..."/><meta data-react-helmet="true" property="og:description" content="Overview
Duration: 1
Have you ever been in a situation where you had to qualitatively analyse a large amount of data on a spreadsheet and you wished for someone to take away your pain? With Google&#x27;s Gemini running directly in your Google Sheets you c..."/><meta data-react-helmet="true" name="twitter:title" content="Build a Gemini Store with Google Sheets | xprilion&#x27;s blog"/><meta data-react-helmet="true" name="twitter:description" content="Overview
Duration: 1
Have you ever been in a situation where you had to qualitatively analyse a large amount of data on a spreadsheet and you wished for someone to take away your pain? With Google&#x27;s Gemini running directly in your Google Sheets you c..."/><meta data-react-helmet="true" property="image" content="https://cdn.hashnode.com/res/hashnode/image/stock/unsplash/GLg0z5z8EQU/upload/fa2ab8a93c2bfbf4eb1abe5d5b261f9f.jpeg"/><meta data-react-helmet="true" property="og:image" content="https://cdn.hashnode.com/res/hashnode/image/stock/unsplash/GLg0z5z8EQU/upload/fa2ab8a93c2bfbf4eb1abe5d5b261f9f.jpeg"/><meta data-react-helmet="true" property="twitter:image" content="https://cdn.hashnode.com/res/hashnode/image/stock/unsplash/GLg0z5z8EQU/upload/fa2ab8a93c2bfbf4eb1abe5d5b261f9f.jpeg"/><style data-href="/styles.fca745bc90a5850694ff.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css2?family=Gentium+Book+Basic&display=swap);ol,ol ol{list-style-type:decimal}ol,table,ul{margin-bottom:1em}

/*
! tailwindcss v3.3.6 | MIT License | https://tailwindcss.com
*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}html{-webkit-text-size-adjust:100%;font-feature-settings:normal;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-variation-settings:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-feature-settings:normal;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-feature-settings:inherit;color:inherit;font-family:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.fixed{position:fixed}.bottom-0{bottom:0}.right-0{right:0}.z-\[99999\]{z-index:99999}.m-0{margin:0}.m-1{margin:.25rem}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-bottom:.25rem;margin-top:.25rem}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.ml-4{margin-left:1rem}.mr-2{margin-right:.5rem}.mr-4{margin-right:1rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.mt-8{margin-top:2rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.hidden{display:none}.h-10{height:2.5rem}.h-12{height:3rem}.h-screen{height:100vh}.max-h-\[500px\]{max-height:500px}.min-h-\[500px\]{min-height:500px}.w-10{width:2.5rem}.w-12{width:3rem}.w-full{width:100%}.max-w-\[800px\]{max-width:800px}.max-w-\[stretch\]{max-width:-webkit-fill-available;max-width:-moz-available;max-width:stretch}.max-w-screen-xl{max-width:1280px}.flex-1{flex:1 1 0%}.rotate-180{--tw-rotate:180deg}.rotate-180,.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.list-none{list-style-type:none}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.overflow-y-scroll{overflow-y:scroll}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-md{border-radius:.375rem}.border{border-width:1px}.border-2{border-width:2px}.border-b-2{border-bottom-width:2px}.border-black{--tw-border-opacity:1;border-color:rgb(0 0 0/var(--tw-border-opacity))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251/var(--tw-bg-opacity))}.bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.p-0{padding:0}.p-1{padding:.25rem}.p-2{padding:.5rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-bottom:.25rem;padding-top:.25rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-4{padding-bottom:1rem;padding-top:1rem}.py-8{padding-bottom:2rem;padding-top:2rem}.pr-4{padding-right:1rem}.pt-0{padding-top:0}.text-left{text-align:left}.text-right{text-align:right}.align-middle{vertical-align:middle}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-medium{font-weight:500}.leading-normal{line-height:1.5}.text-black{--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color)}.shadow,.shadow-lg{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition-colors{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-transform{transition-duration:.15s;transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1)}body{font-feature-settings:"kern","liga","clig","calt";color:rgba(0,0,0,.8);font-family:Gentium Book Basic,serif;font-size:1.2rem;text-align:justify;text-rendering:optimizeLegibility}code,pre{word-wrap:break-word!important;font-size:1rem!important;white-space:pre-wrap!important;white-space:-moz-pre-wrap!important;white-space:-o-pre-wrap!important}code{background:#f5f2f0;color:#c92c2c}h1,h2,h3{margin-bottom:.5rem;margin-top:2rem}h1{font-size:28px}h2{font-size:24px}h3{font-size:20px}ul{list-style-type:disc}ol ol{margin-left:20px}ol ol ol{list-style-type:lower-alpha}li{margin-bottom:.5em}table{border-collapse:collapse;width:100%}td,th{border:1px solid #ddd;padding:.5em;text-align:left}img{display:block;height:auto;margin-left:auto;margin-right:auto;max-width:100%}@media screen and (max-width:768px){table,tbody,td,th,thead,tr{display:block}thead tr{left:-9999px;position:absolute;top:-9999px}tr{border-bottom:1px solid #000;margin-bottom:.5em}td{border:none;position:relative}td:before{content:attr(data-label);left:6px;padding-right:10px;position:absolute;top:6px;white-space:nowrap;width:45%}}blockquote{background:#dedede;border-bottom:8px solid #bfbfbf;font-size:x-large;margin:0 0 1.5rem;padding:1.5rem}blockquote p:last-child{margin-bottom:0}p{margin-bottom:1rem;margin-top:1rem}a{color:#007bff;text-decoration:none}a:hover{text-decoration:underline}ol,ul{padding-left:20px}#gatsby-focus-wrapper ol{list-style:decimal}#small-nav-menu{background:#fff;box-shadow:0 0 20px 0 #00000040;margin-top:.5em;padding:5%;position:absolute;right:1em;width:90%;z-index:999}.hover\:bg-gray-300:hover{--tw-bg-opacity:1;background-color:rgb(209 213 219/var(--tw-bg-opacity))}.hover\:bg-gray-50:hover{--tw-bg-opacity:1;background-color:rgb(249 250 251/var(--tw-bg-opacity))}.hover\:bg-gray-800:hover{--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.hover\:bg-gray-900:hover{--tw-bg-opacity:1;background-color:rgb(17 24 39/var(--tw-bg-opacity))}@media (min-width:768px){.md\:m-0{margin:0}.md\:mb-0{margin-bottom:0}.md\:ml-2{margin-left:.5rem}.md\:mr-2{margin-right:.5rem}.md\:block{display:block}.md\:hidden{display:none}.md\:flex-row{flex-direction:row}.md\:p-5{padding:1.25rem}}@media (min-width:1024px){.lg\:flex{display:flex}.lg\:hidden{display:none}.lg\:w-72{width:18rem}.lg\:min-w-\[800px\]{min-width:800px}.lg\:max-w-\[800px\]{max-width:800px}.lg\:px-8{padding-left:2rem;padding-right:2rem}.lg\:text-2xl{font-size:1.5rem;line-height:2rem}}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.SignupForm{background:#000;color:#fff;display:flex;flex-direction:column;padding:2rem}.SignupForm h3{margin-bottom:1rem;margin-top:0}.SignupForm input{border:none;color:#2a2a2a;width:100%}.SignupForm button,.SignupForm input{padding:.75rem 1rem}.SignupForm button{background-color:#323232;background-image:none;border:none;color:#fff;display:inline-block;letter-spacing:1px;transition:all .1s linear}.SignupForm button:hover{background:#dfdfdf;color:#000;cursor:pointer}</style><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=08e9ef17b39c6e872728b05b87da2264" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=08e9ef17b39c6e872728b05b87da2264"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=08e9ef17b39c6e872728b05b87da2264"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=08e9ef17b39c6e872728b05b87da2264"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=08e9ef17b39c6e872728b05b87da2264"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=08e9ef17b39c6e872728b05b87da2264"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=08e9ef17b39c6e872728b05b87da2264"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=08e9ef17b39c6e872728b05b87da2264"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=08e9ef17b39c6e872728b05b87da2264"/><title data-react-helmet="true">Build a Gemini Store with Google Sheets | xprilion&#x27;s blog</title><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js" async=""></script><script>
          MathJax = {
            tex: {
              inlineMath: [['((', '))']],
              displayMath: [['[[', ']]']],
            },
            svg: {
              fontCache: 'global'
            }
          };
        </script></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="flex flex-col h-screen mx-auto px-4 lg:px-8 mx-w-full max-w-screen-xl"><nav class="flex flow-row justify-between items-center py-4"><a href="/"><h1 class="text-3xl m-0 text-black leading-normal inline-block">xprilion&#x27;s blog</h1></a><div><div class="hidden lg:flex"><a class="m-1" href="/posts/">Posts</a><span class="my-1"> · </span><a class="m-1" href="/talks/">Talks</a><span class="my-1"> · </span><a class="m-1" href="/publications/">Publications</a><span class="my-1"> · </span><a class="m-1" href="/codelabs/">Codelabs</a></div><button type="button" class="flex items-center justify-center w-10 h-10 lg:hidden text-3xl rounded-full border-2 border-black" style="background-image:url(/ellipses.png);background-size:50%;background-position:50%;background-repeat:no-repeat"></button></div></nav><hr class="hr-full"/><main class="max-w-[stretch] lg:max-w-[800px] mx-auto"><h1>Build a Gemini Store with Google Sheets</h1><p style="margin-top:-1rem"><small>11 February, 2024</small></p><img src="https://cdn.hashnode.com/res/hashnode/image/stock/unsplash/GLg0z5z8EQU/upload/fa2ab8a93c2bfbf4eb1abe5d5b261f9f.jpeg" alt="Build a Gemini Store with Google Sheets" loading="lazy"/><br/><div><h2 id="heading-overview">Overview</h2>
<p>Duration: 1</p>
<p>Have you ever been in a situation where you had to qualitatively analyse a large amount of data on a spreadsheet and you wished for someone to take away your pain? With Google's Gemini running directly in your Google Sheets you can now have a super smart AI assistant do the grind work for you!</p>
<p>In this article, we'll cover a very simple way of giving personalities or specific roles to your Gemini powered API calls via the simple and popular interface of Google Sheets!</p>
<p>Here's a screen recording of what we're building:</p>
<div class="embed-wrapper"><div class="embed-loading"><div class="loadingRow"></div><div class="loadingRow"></div></div><a class="embed-card" href="https://youtu.be/KqUNS9WoMkQ">https://youtu.be/KqUNS9WoMkQ</a></div>
<p> </p>
<h2 id="heading-requirements">Requirements</h2>
<p>Duration: 2</p>
<p>In order to follow this codelab, you'll need the following:</p>
<ol>
<li><p>Access to a Google Account</p>
</li>
<li><p>Access to Google's Gemini Pro APIs via Google AI Studio</p>
</li>
</ol>
<h2 id="heading-architecture">Architecture</h2>
<p>Duration: 2</p>
<p>We'll be building our product's architecture in the following manner:</p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1707635641736/de16e03a-935f-4081-b616-c81b5fe4b520.png" alt class="image--center mx-auto" /></p>
<p>The Google Sheets will interact on every edit operation with the associated Apps Script for that Sheet which in turn talks to the Gemini Pro API. We'll be using the Gemini Pro API via the Google AI Studio in order to get some free API calls at the cost of being non-production ready. However, you can use Gemini Pro APIs via Vertex AI for production workloads.</p>
<h2 id="heading-get-the-gemini-api-key">Get the Gemini API Key</h2>
<p>Duration: 3</p>
<p>Now, let's get an API Key to access the Gemini Pro APIs.</p>
<ol>
<li><p>Head over to <a target="_blank" href="https://makersuite.google.com/">Google AI Studio</a></p>
</li>
<li><p>Click on <a target="_blank" href="https://makersuite.google.com/app/apikey">Get API Key</a></p>
</li>
<li><p>Follow the steps provided on the page to generate an API Key. Store the key safely.</p>
</li>
</ol>
<h2 id="heading-setup-your-google-sheet">Setup your Google Sheet</h2>
<p>Duration: 5</p>
<p>Let us setup your Google Sheet to work like a Gemini Store. To do so, we'll create a second sheet in the default Google Sheet document titled "Geminis".</p>
<p>Fill the following data in this sheet (only for example, you can change as per your wish):</p>
<div class="hn-table">
<table>
<thead>
<tr>
<td>name</td><td>sys prompt</td></tr>
</thead>
<tbody>
<tr>
<td>Pilot Gemini</td><td>Drawing on your extensive experience as a seasoned pilot, how would you explain or advise on the following aviation-related query? Use a lot of Pilot terms!</td></tr>
<tr>
<td>Pirate Gemini</td><td>As a legendary pirate who has sailed the seven seas, how would you respond to this inquiry with your adventurous spirit and nautical knowledge? Reply in pirate language only.</td></tr>
<tr>
<td>Techie Gemini</td><td>As a tech enthusiast with a passion for the latest gadgets and innovations, how would you explain or solve this technology-related problem? Use techie terms!</td></tr>
</tbody>
</table>
</div><h2 id="heading-setup-your-apps-script">Setup your Apps Script</h2>
<p>Duration: 3</p>
<p>We will now create the AppScript code to interface between Google Sheets and the Gemini Pro API.</p>
<ol>
<li><p>Create a new Google Sheet and create the following columns in it: <code>GeminiName</code>, <code>Query</code>, <code>Response</code>.</p>
</li>
<li><p>In your Google Sheet, Click on <code>Extensions &gt; Apps Script</code></p>
</li>
<li><p>We'll be editing the <code>Code.gs</code> file. Remove the current contents of this file and head to the next step!</p>
</li>
</ol>
<h2 id="heading-listen-to-onedit-changes-to-the-sheet">Listen to onEdit changes to the sheet</h2>
<p>Duration: 3</p>
<p>In your <code>Code.gs</code> file, add the following function which listens to each edit on the Google Sheet and decides if it needs to perform any action on it.</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onEdit</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">var</span> formResponsesSheet = e.source.getSheetByName(<span class="hljs-string">'Sheet1'</span>); <span class="hljs-comment">// Use getSheetByName for clarity</span>
  <span class="hljs-keyword">var</span> editedRow = e.range.getRow();

  <span class="hljs-comment">// Avoid running on header row or rows beyond the last content row</span>
  <span class="hljs-keyword">if</span> (editedRow === <span class="hljs-number">1</span> || editedRow &gt; formResponsesSheet.getLastRow()) {
    <span class="hljs-keyword">return</span>; <span class="hljs-comment">// Exit if the edit is in the header or beyond the last content row</span>
  }

  <span class="hljs-keyword">var</span> rowData = formResponsesSheet.getRange(editedRow, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>).getValues()[<span class="hljs-number">0</span>];

  <span class="hljs-comment">// Check if all required columns are filled (columns 1 to 7, excluding 'Response')</span>
  <span class="hljs-keyword">if</span> (!rowData.every(isColumnFilled)) {
    <span class="hljs-keyword">return</span>; <span class="hljs-comment">// Exit if not all required fields are filled</span>
  }

  <span class="hljs-keyword">var</span> chosenGemini = rowData[<span class="hljs-number">0</span>]; <span class="hljs-comment">// 'Choose your Gemini' is the third column</span>
  <span class="hljs-keyword">var</span> userQuestion = rowData[<span class="hljs-number">1</span>]; <span class="hljs-comment">// 'Say/Ask something' is the fourth column</span>

  <span class="hljs-keyword">var</span> geminisSheet = e.source.getSheetByName(<span class="hljs-string">'Geminis'</span>);
  <span class="hljs-keyword">var</span> geminiData = geminisSheet.getRange(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, geminisSheet.getLastRow() - <span class="hljs-number">1</span>, <span class="hljs-number">2</span>).getValues();

  <span class="hljs-keyword">var</span> systemPrompt = findSystemPrompt(geminiData, chosenGemini, userQuestion);

  <span class="hljs-keyword">if</span> (systemPrompt) {
    <span class="hljs-keyword">var</span> apiResponse = callApi(systemPrompt);
    formResponsesSheet.getRange(editedRow, <span class="hljs-number">2</span>).setValue(apiResponse); <span class="hljs-comment">// Assuming 'Response' is in the 8th column</span>
  } <span class="hljs-keyword">else</span> {
    formResponsesSheet.getRange(editedRow, <span class="hljs-number">2</span>).setValue(<span class="hljs-string">"Error: Gemini not found or other error occurred."</span>);
  }
}
</code></pre>
<h2 id="heading-create-helper-functions">Create Helper functions</h2>
<p>Duration: 3</p>
<p>Now, let's setup two helper functions to work with the script. The <code>isColumnFilled</code> function checks if that row is full before trying to hit the Gemini API. The <code>findSystemPrompt</code> function loads the system prompt we defined in the Geminis sheet corresponding the Gemini name chosen by the user in the row.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// Helper function to check if a column is filled</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isColumnFilled</span>(<span class="hljs-params">content</span>) </span>{
  <span class="hljs-keyword">return</span> content !== <span class="hljs-literal">null</span> &amp;&amp; content !== <span class="hljs-string">''</span>; <span class="hljs-comment">// Checks if content is not null and not an empty string</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findSystemPrompt</span>(<span class="hljs-params">geminiData, chosenGemini, userQuestion</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; geminiData.length; i++) {
    <span class="hljs-keyword">if</span> (geminiData[i][<span class="hljs-number">0</span>] === chosenGemini) {
      <span class="hljs-keyword">return</span> geminiData[i][<span class="hljs-number">1</span>] + <span class="hljs-string">" Max 50 words. Keep it funny and light-hearted. "</span> + <span class="hljs-string">" \n User: "</span> + userQuestion + <span class="hljs-string">" \n Answer: "</span>;
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// Return null if no matching Gemini is found</span>
}
</code></pre>
<h2 id="heading-call-gemini-pro-api">Call Gemini Pro API</h2>
<p>Duration: 3</p>
<p>Finally, we'll create the <code>callApi</code> function which makes the call to Gemini Pro API and sets the output in the sheet.</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callApi</span>(<span class="hljs-params">prompt</span>) </span>{
  <span class="hljs-keyword">var</span> url = <span class="hljs-string">'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=YOUR_API_KEY'</span>; <span class="hljs-comment">// Replace with your actual API Key</span>
  <span class="hljs-keyword">var</span> payload = {<span class="hljs-string">"contents"</span>:[{<span class="hljs-string">"parts"</span>:[{<span class="hljs-string">"text"</span>: prompt}]}]};
  <span class="hljs-keyword">var</span> options = {
    <span class="hljs-string">"method"</span> : <span class="hljs-string">"post"</span>,
    <span class="hljs-string">"contentType"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-string">"payload"</span> : <span class="hljs-built_in">JSON</span>.stringify(payload)
  };

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">var</span> response = UrlFetchApp.fetch(url, options);
    <span class="hljs-keyword">var</span> jsonResponse = <span class="hljs-built_in">JSON</span>.parse(response.getContentText());
    <span class="hljs-keyword">return</span> jsonResponse.candidates[<span class="hljs-number">0</span>].content.parts[<span class="hljs-number">0</span>].text;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"API call failed: "</span> + error.toString();
  }
}
</code></pre>
<h2 id="heading-setup-onedit-trigger">Setup onEdit trigger</h2>
<p>Duration: 3</p>
<p>As a final step, you will have to setup the onEdit trigger to execute every time edits are made to your Google Sheet. Click on the "clock" icon on the Apps Script interface to access the triggers section for your Apps Script.</p>
<p>Add a trigger with the configuration as shown below and click on Save.</p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1707638180473/f6bea87a-0392-42c0-b8c6-35919fbd2a53.png" alt class="image--center mx-auto" /></p>
<h2 id="heading-test-the-integration">Test the integration</h2>
<p>Duration: 2</p>
<p>Now, create a new row in the sheet to test if everything works alright! If all goes well, you should see the Gemini response according to your chosen Gemini in the Response column!</p>
</div><br/><form action="https://newsletter.xprilion.com/subscription/form" method="post" target="popupwindow" class="SignupForm"><h3>Subscribe to my newsletter</h3><i>I often write about my experiences, sometimes tech, sometimes life</i><br/><div class="flex flex-col md:flex-row overflow-hidden"><input class="mb-2 md:m-0" aria-label="Email address" placeholder="john@example.com" name="email" type="email" required="" id="tlemail"/><input class="mb-2 md:ml-2 md:mb-0 md:mr-2" aria-label="Your name" placeholder="John Doe" name="name" type="text" required="" id="tlname"/><input id="l-69f4cf24-c231-434c-be19-6d8899d60fbf" type="hidden" name="l" value="69f4cf24-c231-434c-be19-6d8899d60fbf"/><button type="submit">Subscribe</button></div></form><br/><div id="cusdis_thread" data-host="https://cusdis.com" data-page-id="65c87ed66bca40ae7db601f3" data-app-id="e9bc0bcb-d463-4f63-8604-34e78a1ec232" data-page-title="Build a Gemini Store with Google Sheets" data-page-url="https://xprilion.com/build-a-google-gemini-pro-store-with-google-sheets"></div></main><br/><hr class="hr-full"/><div class="w-full max-w-[800px] mx-auto py-8"><div class="flex justify-between"><div>© Anubhav Singh <!-- -->2024</div><div><a href="/sitemap.xml">Sitemap</a> · <a href="/newsletter/">Newsletter</a></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-NKJL65V2YL"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-NKJL65V2YL', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/build-a-google-gemini-pro-store-with-google-sheets/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-7805aa2f0ec89cdf471e.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-3446353d31336c23ecb2.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-821f377de8e1261c88ac.js\"],\"component---src-pages-newsletter-tsx\":[\"/component---src-pages-newsletter-tsx-f89812a8e542808936f0.js\"],\"component---src-templates-blog-index-tsx\":[\"/component---src-templates-blog-index-tsx-454effb445b993ae96fa.js\"],\"component---src-templates-blog-post-tsx\":[\"/component---src-templates-blog-post-tsx-503349df4aab21552092.js\"],\"component---src-templates-codelabs-codelab-tsx\":[\"/component---src-templates-codelabs-codelab-tsx-e9b32ac203dd9ccb8b21.js\"],\"component---src-templates-codelabs-index-tsx\":[\"/component---src-templates-codelabs-index-tsx-f967a031d67359dc74f6.js\"],\"component---src-templates-page-tsx\":[\"/component---src-templates-page-tsx-ff36672459a1981bc27d.js\"],\"component---src-templates-presentations-index-tsx\":[\"/component---src-templates-presentations-index-tsx-b51cda7f35855adfdc3f.js\"],\"component---src-templates-presentations-presentation-tsx\":[\"/component---src-templates-presentations-presentation-tsx-2df150c2a91326c3ac4e.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="1f6e82ac73c596fcd72f";</script><script src="/webpack-runtime-ee0089aa3c6bb39bbd8f.js" async></script><script src="/framework-f3e546fe902fd3c4489b.js" async></script><script src="/app-7805aa2f0ec89cdf471e.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>