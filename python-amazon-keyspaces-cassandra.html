<!DOCTYPE html><html lang="en" class="__variable_6ab973"><head><meta charSet="utf-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/22966f4f11fece13-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/3df4cf0b22f61940-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/a481f011d1f4a14b-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/feff4f1fc62fae3c-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/2dba37557e579c7e.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/17c99d248f3289f7.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/f3b8208e8dab82f4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-0e89f3edb1eec667.js"/><script src="/_next/static/chunks/a82cbd8b-b3a1b1aa1798277d.js" async=""></script><script src="/_next/static/chunks/261-9869fd9e23c1aca9.js" async=""></script><script src="/_next/static/chunks/main-app-60c99745b0326fba.js" async=""></script><script src="/_next/static/chunks/app/layout-29f44809ba3fe938.js" async=""></script><script src="/_next/static/chunks/943-eb5c9570e2ea5452.js" async=""></script><script src="/_next/static/chunks/328-beff309a0d839380.js" async=""></script><script src="/_next/static/chunks/224-ed8f8dcad199b1cb.js" async=""></script><script src="/_next/static/chunks/app/(blog)/%5Bslug%5D/page-f23f643be99b5c74.js" async=""></script><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js" as="script"/><meta name="next-size-adjust" content=""/><link rel="icon" type="image/png" href="/apple-icon.png" sizes="96x96"/><link rel="icon" type="image/svg+xml" href="/icon0.svg"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><meta name="apple-mobile-web-app-title" content="xprilion&#x27;s blog"/><link rel="manifest" href="/manifest.json"/><meta name="theme-color" content="#7b46f6"/><meta property="og:title" content="xprilion&#x27;s blog"/><meta property="og:description" content="Hey, I&#x27;m Anubhav Singh. I love building software, mixing stacks and making memes."/><meta property="og:image" content="/favicon.png"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@xprilion"/><meta name="twitter:creator" content="@xprilion"/><meta name="twitter:title" content="xprilion&#x27;s blog"/><meta name="twitter:description" content="Hey, I&#x27;m Anubhav Singh. I love building software, mixing stacks and making memes."/><meta name="twitter:image" content="/favicon.png"/><meta itemProp="name" content="xprilion&#x27;s blog"/><meta itemProp="description" content="Hey, I&#x27;m Anubhav Singh. I love building software, mixing stacks and making memes."/><meta itemProp="image" content="/favicon.png"/><title>Working with Amazon Keyspaces Cassandra distribution using Python</title><meta name="description" content="Cassandra is a popular NoSQL database with capabilities to handle massive data by using a distributed array of commodity hardware. After a boring introduction, here&#x27;s the fun part - Cassandra is a Facebook contribution to the world of Open Source, having been developed to handle the inbox search feature in Facebook almost a decade ago, and since it has been handed over to the Apache Software Foundation, it has been among the top open source projects under the organization.

Cassandra powers the "/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="antialiased"><script>((e,t,r,n,o,a,i,u)=>{let l=document.documentElement,s=["light","dark"];function c(t){var r;(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,n=r&&a?o.map(e=>a[e]||e):o;r?(l.classList.remove(...n),l.classList.add(a&&a[t]?a[t]:t)):l.setAttribute(e,t)}),r=t,u&&s.includes(r)&&(l.style.colorScheme=r)}if(n)c(n);else try{let e=localStorage.getItem(t)||r,n=i&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(n)}catch(e){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="max-w-6xl mx-auto px-1 md:px-4 font-gentium"><div class="flex flex-col min-h-screen px-2 md:px-4 bg-background text-foreground"><nav class="flex flex-row justify-between items-center py-4 border-b border-border relative"><a class="flex items-center justify-center" href="/"><h1 class="text-xl sm:text-2xl m-0 text-foreground font-normal leading-normal inline-block font-gentium truncate max-w-[200px] sm:max-w-none">xprilion&#x27;s blog</h1></a><div class="flex items-center gap-4"><div class="hidden lg:flex items-center font-gentium text-lg"><div><a class="m-1 text-blue-600 dark:text-primary hover:text-blue-600 dark:hover:text-primary hover:underline" href="/posts">Posts<!-- --> </a></div><div><span class="my-1 text-foreground"> · </span><a class="m-1 text-blue-600 dark:text-primary hover:text-blue-600 dark:hover:text-primary hover:underline" href="/talks">Talks<!-- --> </a></div><div><span class="my-1 text-foreground"> · </span><a class="m-1 text-blue-600 dark:text-primary hover:text-blue-600 dark:hover:text-primary hover:underline" href="/publications">Publications<!-- --> </a></div><div><span class="my-1 text-foreground"> · </span><a class="m-1 text-blue-600 dark:text-primary hover:text-blue-600 dark:hover:text-primary hover:underline" href="/codelabs">Codelabs<!-- --> </a></div></div><button id="mobile-menu-button" type="button" class="flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 lg:hidden text-3xl rounded-full border-2 border-foreground dark:invert dark:border-background" style="background-image:url(/ellipses.png);background-size:50%;background-position:50%;background-repeat:no-repeat" aria-label="Toggle navigation menu" aria-expanded="false"></button></div></nav><main class="flex-grow max-w-3xl mx-auto w-full py-8 px-1 md:px-4"><div class="mb-6"><a class="text-blue-600 hover:underline mb-4 block" href="/posts">← Back to all posts</a><h1 class="text-2xl md:text-3xl font-bold mb-2">Working with Amazon Keyspaces Cassandra distribution using Python</h1><p class="text-gray-600 dark:text-gray-200 text-sm ">17 September, 2020</p></div><div class="prose prose-blue max-w-none"></div><script>(self.__next_s=self.__next_s||[]).push([0,{"children":"\n          MathJax = {\n            tex: {\n              inlineMath: [['((', '))']],\n              displayMath: [['[[', ']]']],\n            },\n            svg: {\n              fontCache: 'global'\n            }\n          };\n        ","id":"MathJax-config"}])</script></main><div class="w-full mx-auto py-6 max-w-6xl px-4 border-t border-border"><div class="flex flex-col sm:flex-row justify-between gap-2"><div class="text-center sm:text-left text-foreground">© Anubhav Singh <!-- -->2025</div><div class="text-center sm:text-right"><a class="text-foreground hover:text-blue-600 dark:hover:text-primary" href="/sitemap.xml">Sitemap</a><span class="mx-1 text-foreground">·</span><a class="text-foreground hover:text-blue-600 dark:hover:text-primary" href="/newsletter">Newsletter</a></div></div></div></div></div><!--$--><!--/$--><!--$--><!--/$--><script src="/_next/static/chunks/webpack-0e89f3edb1eec667.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[6575,[\"177\",\"static/chunks/app/layout-29f44809ba3fe938.js\"],\"ThemeProvider\"]\n3:I[4922,[],\"\"]\n4:I[3720,[],\"\"]\n6:I[2466,[],\"MetadataBoundary\"]\n8:I[2466,[],\"OutletBoundary\"]\nb:I[6114,[],\"AsyncMetadataOutlet\"]\nd:I[2466,[],\"ViewportBoundary\"]\nf:I[4797,[],\"\"]\n:HL[\"/_next/static/media/22966f4f11fece13-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/3df4cf0b22f61940-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/a481f011d1f4a14b-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/feff4f1fc62fae3c-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/2dba37557e579c7e.css\",\"style\"]\n:HL[\"/_next/static/css/17c99d248f3289f7.css\",\"style\"]\n:HL[\"/_next/static/css/f3b8208e8dab82f4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"U0y-XNYKQEr6GA245v640\",\"p\":\"\",\"c\":[\"\",\"python-amazon-keyspaces-cassandra\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"python-amazon-keyspaces-cassandra\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/2dba37557e579c7e.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/17c99d248f3289f7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__variable_6ab973\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"href\":\"/apple-icon.png\",\"sizes\":\"96x96\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/svg+xml\",\"href\":\"/icon0.svg\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"180x180\",\"href\":\"/apple-touch-icon.png\"}],[\"$\",\"meta\",null,{\"name\":\"apple-mobile-web-app-title\",\"content\":\"xprilion's blog\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/manifest.json\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#7b46f6\"}],[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",null,{\"itemProp\":\"name\",\"content\":\"xprilion's blog\"}],[\"$\",\"meta\",null,{\"itemProp\":\"description\",\"content\":\"Hey, I'm Anubhav Singh. I love building software, mixing stacks and making memes.\"}],[\"$\",\"meta\",null,{\"itemProp\":\"image\",\"content\":\"/favicon.png\"}],[\"$\",\"meta\",null,{\"property\":\"og:title\",\"content\":\"xprilion's blog\"}],[\"$\",\"meta\",null,{\"property\":\"og:description\",\"content\":\"Hey, I'm Anubhav Singh. I love building software, mixing stacks and making memes.\"}],[\"$\",\"meta\",null,{\"property\":\"og:image\",\"content\":\"/favicon.png\"}],[\"$\",\"meta\",null,{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:site\",\"content\":\"@xprilion\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:creator\",\"content\":\"@xprilion\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:title\",\"content\":\"xprilion's blog\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:description\",\"content\":\"Hey, I'm Anubhav Singh. I love building software, mixing stacks and making memes.\"}],[\"$\",\"meta\",null,{\"name\":\"twitter:image\",\"content\":\"/favicon.png\"}]]}],[\"$\",\"body\",null,{\"className\":\"antialiased\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}]]}],{\"children\":[\"(blog)\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:style\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":\"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:children:props:children:1:props:style\",\"children\":404}],[\"$\",\"div\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:children:props:children:2:props:style\",\"children\":[\"$\",\"h2\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:1:props:children:props:children:props:notFound:0:1:props:children:props:children:2:props:children:props:style\",\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"python-amazon-keyspaces-cassandra\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[\"$\",\"$L6\",null,{\"children\":\"$L7\"}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f3b8208e8dab82f4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L8\",null,{\"children\":[\"$L9\",\"$La\",[\"$\",\"$Lb\",null,{\"promise\":\"$@c\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"2-k5IeYjwCg1qwOVxlhuS\",{\"children\":[[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:\"$Sreact.suspense\"\n11:I[6114,[],\"AsyncMetadata\"]\n7:[\"$\",\"$10\",null,{\"fallback\":null,\"children\":[\"$\",\"$L11\",null,{\"promise\":\"$@12\"}]}]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"13:I[1701,[\"943\",\"static/chunks/943-eb5c9570e2ea5452.js\",\"328\",\"static/chunks/328-beff309a0d839380.js\",\"224\",\"static/chunks/224-ed8f8dcad199b1cb.js\",\"356\",\"static/chunks/app/(blog)/%5Bslug%5D/page-f23f643be99b5c74.js\"],\"default\"]\n14:I[1999,[\"943\",\"static/chunks/943-eb5c9570e2ea5452.js\",\"328\",\"static/chunks/328-beff309a0d839380.js\",\"224\",\"static/chunks/224-ed8f8dcad199b1cb.js\",\"356\",\"static/chunks/app/(blog)/%5Bslug%5D/page-f23f643be99b5c74.js\"],\"\"]\n15:I[1106,[\"943\",\"static/chunks/943-eb5c9570e2ea5452.js\",\"328\",\"static/chunks/328-beff309a0d839380.js\",\"224\",\"static/chunks/224-ed8f8dcad199b1cb.js\",\"356\",\"static/chunks/app/(blog)/%5Bslug%5D/page-f23f643be99b5c74.js\"],\"default\"]\n17:I[4046,[\"943\",\"static/chunks/943-eb5c9570e2ea5452.js\",\"328\",\"static/chunks/328-beff309a0d839380.js\",\"224\",\"static/chunks/224-ed8f8dcad199b1cb.js\",\"356\",\"static/chunks/app/(blog)/%5Bslug%5D/page-f23f643be99b5c74.js\"],\"\"]\n16:T273f,"])</script><script>self.__next_f.push([1,"\u003cp\u003e\u003ca href=\"https://cassandra.apache.org/doc/latest/\"\u003eCassandra\u003c/a\u003e is a popular NoSQL database with capabilities to handle massive data by using a distributed array of commodity hardware. After a boring introduction, here's the fun part - Cassandra is a Facebook contribution to the world of Open Source, having been developed to handle the inbox search feature in Facebook almost a decade ago, and since it has been handed over to the \u003ca href=\"https://www.apache.org/\"\u003eApache Software Foundation\u003c/a\u003e, it has been among the top open source projects under the organization.\u003c/p\u003e\u003cp\u003eCassandra powers the highly intensive queries in the applications of several major tech players - Instagram, Netflix, Facebook (before replacing it with HBase and further HBase with MyRocks), Twitter (before replacing it with in-house Manhattan), Walmart Labs, CERN, Cisco WebEx, and many more. You can read an extensive praise-o-logy of Cassandra on this \u003ca href=\"https://ubuntu.com/blog/apache-cassandra-top-benefits\"\u003eUbuntu blog titled What is Cassandra and why are big tech companies using it?\u003c/a\u003e\u003c/p\u003e\u003cp\u003eWhile it can be a hassle to install and maintain a Cassandra database server online, \u003ca href=\"https://aws.amazon.com/keyspaces/\"\u003eAmazon Keyspaces\u003c/a\u003e offering by Amazon Web Services makes it a no-brainer to use. A similar powerful offering is provided by Datastax by the name \u003ca href=\"https://www.datastax.com/products/datastax-astra\"\u003eAstra\u003c/a\u003e. Both provide a managed service for Cassandra database which you can readily use both for development and production needs. Big plus - you can try both for free!\u003c/p\u003e\u003cp\u003eIn this tutorial, I shall be moving ahead with Amazon Keyspaces, considering the dearth of a complete example of how to use it on the Internet. You can very easily modify it to work with Datastax Astra.\u003c/p\u003e\u003cp\u003eFirst off, before we make any queries, head over to the \u003ca href=\"https://console.aws.amazon.com/keyspaces/home\"\u003eAmazon Keyspaces dashboard\u003c/a\u003e and create a Keyspace and a sample Table using the Dashboard or the CQL Editor. Both actions being fairly simple, I shall leave it up to you to \u003ca href=\"https://docs.aws.amazon.com/keyspaces/latest/devguide/getting-started.ddl.html\"\u003eexplore how to get it done\u003c/a\u003e. Let's move ahead with how you can use them with a Python application.\u003c/p\u003e\u003cp\u003eFor convenience, I shall assume that the keyspace you created is named \u003ccode\u003etest_keyspace\u003c/code\u003e and the table is named \u003ccode\u003eusers\u003c/code\u003e. The definition for \u003ccode\u003eusers\u003c/code\u003e table is expected to be -\u003c/p\u003e\n\u003c!--kg-card-begin: html--\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eColumn\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eid\u003c/td\u003e\n\u003ctd\u003euuid\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ename\u003c/td\u003e\n\u003ctd\u003evarchar\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eage\u003c/td\u003e\n\u003ctd\u003einteger\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecity\u003c/td\u003e\n\u003ctd\u003evarchar\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003c!--kg-card-end: html--\u003e\n\u003cp\u003eYou'll need to download a \u003ca href=\"https://www.comodo.com/resources/small-business/digital-certificates.php\"\u003eDigital Certificate\u003c/a\u003e provided by Amazon to be able to connect to Keyspaces since the service only connects through TLS. To do so, use the following command in a terminal window -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-bash\"\u003ecurl https://www.amazontrust.com/repository/AmazonRootCA1.pem -O\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eCreate a new folder in your working directory named \u003ccode\u003e.cassandra\u003c/code\u003e and move the \u003ccode\u003eAmazonRootCA1.pem\u003c/code\u003e file there. Just cleaning up the working space, tbh, you can keep it wherever you wish, as long as its accessible to your Python script.\u003c/p\u003e\u003cp\u003eNext, we shall need the \u003ccode\u003ecassandra-driver\u003c/code\u003e library for quick functionality to use Cassandra with Python. Run the following command to install it -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-bash\"\u003epip install cassandra-driver\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow, we shall write a small barebones wrapper object for our connection with Amazon Keyspaces. Create a file called \u003ca href=\"http://db.py\"\u003e\u003ccode\u003edb.py\u003c/code\u003e\u003c/a\u003e in your working directory.\u003c/p\u003e\u003cp\u003eAdd the following code to make all necessary imports -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003efrom cassandra.auth import PlainTextAuthProvider\nfrom cassandra.cluster import Cluster\nfrom ssl import SSLContext, PROTOCOL_TLSv1_2, CERT_REQUIRED\nfrom cassandra import ConsistencyLevel\nfrom cassandra.query import SimpleStatement\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe above imports indicate a few things -\u003c/p\u003e\u003cul\u003e\u003col\u003e\u003cli\u003eWe're going to be using the \u003ccode\u003ePlainTextAuthProvider\u003c/code\u003e which means at some point we'll need a username and password combination for our connection with the database. We shall come around this.\u003c/li\u003e\u003c/ol\u003e\u003col\u003e\u003cli\u003e\u003ccode\u003eCluster\u003c/code\u003e indicates that we shall be creating an object of the Cassandra Cluster we connect to. This provides cluster level operations which can be useful for you, but not much in the course of this tutorial.\u003c/li\u003e\u003c/ol\u003e\u003col\u003e\u003cli\u003e\u003ccode\u003eSSLContext, PROTOCOL_TLSv1_2, CERT_REQUIRED\u003c/code\u003e are all required for making a TLS connection to the Amazon Keyspaces service.\u003c/li\u003e\u003c/ol\u003e\u003col\u003e\u003cli\u003e\u003ccode\u003eConsistencyLevel\u003c/code\u003e if this is a bouncer, we shall get to overcoming it further down in this tutorial.\u003c/li\u003e\u003c/ol\u003e\u003col\u003e\u003cli\u003e\u003ccode\u003eSimpleStatement\u003c/code\u003e is a simple CSQL statement, no wonders here.\u003c/li\u003e\u003c/ol\u003e\u003c/ul\u003e\u003cp\u003eNext, let's begin using these imports.\u003c/p\u003e\u003cp\u003eCreate a class \u003ccode\u003eCassandra\u003c/code\u003e and add an initialization constructor which creates and connection to the database service -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003eclass Cassandra:\n    def __init__(self):\n        ssl_context = SSLContext(PROTOCOL_TLSv1_2)\n        ssl_context.load_verify_locations('.cassandra/AmazonRootCA1.pem')\n        ssl_context.verify_mode = CERT_REQUIRED\n        auth_provider = PlainTextAuthProvider(\n            username='ServiceUsername',\n            password='ServicePassword')\n        self.cluster = Cluster(\n            ['cassandra.us-east-1.amazonaws.com'],\n            ssl_context=ssl_context,\n            auth_provider=auth_provider,\n            port=9142)\n        self.session = self.cluster.connect(\"test_keyspace\")\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNotice \u003ccode\u003eServiceUsername\u003c/code\u003e and \u003ccode\u003eServicePassword\u003c/code\u003e, you do not yet have them. To create a pair of credentials to use, follow this instructions in \u003ca href=\"https://docs.aws.amazon.com/keyspaces/latest/devguide/programmatic.credentials.html#programmatic.credentials.ssc\"\u003ethis tutorial\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eYour Cluster endpoint (\u003ca href=\"http://cassandra.us-east-1.amazonaws.com\"\u003e\u003ccode\u003ecassandra.us-east-1.amazonaws.com\u003c/code\u003e\u003c/a\u003e) could differ from the one I have used in my example. You can find out your endpoint by visiting \u003ca href=\"https://docs.aws.amazon.com/keyspaces/latest/devguide/programmatic.endpoints.html\"\u003ethis list\u003c/a\u003e and use the endpoint corresponding to your AWS Region.\u003c/p\u003e\u003cp\u003eNow, let's create a method for the \u003ccode\u003eCassandra\u003c/code\u003e class that we can use to execute queries -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003eclass Cassandra:\n    ...\n    def execute(self, query):\n            return self.session.execute(SimpleStatement(\n                query, consistency_level=ConsistencyLevel.LOCAL_QUORUM))\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eLook, we used the \u003ccode\u003eConsistencyLevel\u003c/code\u003e object here! What is this bird?\u003c/p\u003e\u003cfigure class=\"kg-card kg-image-card\"\u003e\u003cimg loading=\"lazy\" src=\"https://digitalpress.fra1.cdn.digitaloceanspaces.com/4ml9m8u/2025/04/image-14.png\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"575\" height=\"323\"\u003e\u003c/figure\u003e\u003cp\u003e\u003cstrong\u003eConsistency Level\u003c/strong\u003e is the number of nodes which need to confirm that a particular write operation into a Cassandra database is successful. In simpler words, since Cassandra is a distributed database, and the data stored in Cassandra is split over multiple nodes, a single write operation is successful only when maximum possible nodes acknowledge the write operation as valid. For this, we use different consistency levels, some of which are - \u003ccode\u003eLOCAL_ONE\u003c/code\u003e, \u003ccode\u003eLOCAL_QUORUM\u003c/code\u003e, \u003ccode\u003eALL\u003c/code\u003e, etc. You can read more about consistency levels in \u003ca href=\"https://www.geeksforgeeks.org/consistency-levels-in-cassandra/\"\u003ethis blog by Ashish Rana on GeeksforGeeks\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eCurrently, Amazon Keyspaces works only with the \u003ccode\u003eLOCAL_QUORUM\u003c/code\u003e consistency level.\u003c/p\u003e\u003cp\u003eNow, we can delve into some action!\u003c/p\u003e\u003cp\u003eCreate a new file called \u003ca href=\"http://main.py\"\u003e\u003ccode\u003emain.py\u003c/code\u003e\u003c/a\u003e (or whatever fancy wording you can think of in 1 second), and put the following lines in it to try inserting a new entry to the database -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003efrom db import Cassandra\n\ncsql = Cassandra()\n\n# Insert Query\nresults = csql.execute(\"INSERT INTO users (id, name, age, city) \\\n                        VALUES (6ab09bec-e68e-48d9-a5f8-97e6fb4c9b47, \\\n                       'John', 24, 'Delhi')\")\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow, save the file and try executing it from the terminal using the following command -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-bash\"\u003epython main.py\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eIf the query is successful, you shall see no errors.\u003c/p\u003e\u003cp\u003eLet's try reading the database and see if we've got the entry right. Comment out the Insert query code in the \u003ca href=\"http://main.py\"\u003e\u003ccode\u003emain.py\u003c/code\u003e\u003c/a\u003e file and add the following lines -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-python\"\u003e# Read query\nresults = csql.execute(\"SELECT * FROM users\")\nprint([x for x in results])\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eYou should see the output similar to this -\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-text\"\u003e[Row(id=UUID('6ab09bec-e68e-48d9-a5f8-97e6fb4c9b47'), city='Delhi', age=24, name='John')]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eIf not, you need to observe the error message and try fixing the code! You can find the full code for this tutorial at - \u003ca href=\"https://github.com/xprilion/python-amazon-keyspaces\"\u003ehttps://github.com/xprilion/python-amazon-keyspaces\u003c/a\u003e\u003c/p\u003e\u003cp\u003eCassandra can be a great tool if you're looking to build highly scalable and mission-critical applications (given you need something like Cassandra, at all) and Amazon Keyspaces makes it very simple and efficient to use and manage.\u003c/p\u003e\u003cp\u003eIt is possible to use Amazon Keyspaces with other backends as well, and I shall leave it for you to explore them at your interest.\u003c/p\u003e\u003cp\u003eThanks for reading this!\u003c/p\u003e"])</script><script>self.__next_f.push([1,"5:[\"$\",\"$L13\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-6\",\"children\":[[\"$\",\"$L14\",null,{\"href\":\"/posts\",\"className\":\"text-blue-600 hover:underline mb-4 block\",\"children\":\"← Back to all posts\"}],[\"$\",\"h1\",null,{\"className\":\"text-2xl md:text-3xl font-bold mb-2\",\"children\":\"Working with Amazon Keyspaces Cassandra distribution using Python\"}],[\"$\",\"p\",null,{\"className\":\"text-gray-600 dark:text-gray-200 text-sm \",\"children\":\"17 September, 2020\"}]]}],null,[\"$\",\"$L15\",null,{\"html\":\"$16\",\"slug\":\"python-amazon-keyspaces-cassandra\",\"title\":\"Working with Amazon Keyspaces Cassandra distribution using Python\"}],[\"$\",\"$L17\",null,{\"id\":\"MathJax-script\",\"src\":\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js\",\"async\":true,\"strategy\":\"afterInteractive\"}],[\"$\",\"$L17\",null,{\"id\":\"MathJax-config\",\"strategy\":\"beforeInteractive\",\"dangerouslySetInnerHTML\":{\"__html\":\"\\n          MathJax = {\\n            tex: {\\n              inlineMath: [['((', '))']],\\n              displayMath: [['[[', ']]']],\\n            },\\n            svg: {\\n              fontCache: 'global'\\n            }\\n          };\\n        \"}}]]}]\n"])</script><script>self.__next_f.push([1,"12:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Working with Amazon Keyspaces Cassandra distribution using Python\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Cassandra is a popular NoSQL database with capabilities to handle massive data by using a distributed array of commodity hardware. After a boring introduction, here's the fun part - Cassandra is a Facebook contribution to the world of Open Source, having been developed to handle the inbox search feature in Facebook almost a decade ago, and since it has been handed over to the Apache Software Foundation, it has been among the top open source projects under the organization.\\n\\nCassandra powers the \"}]],\"error\":null,\"digest\":\"$undefined\"}\nc:{\"metadata\":\"$12:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>